#
# FastQ format
#
datatypes:
  fastq_unit:
    composed_of:
      - sdesc: fastq_unit_sdesc
      - seq: fastq_unit_seq
      - qdesc: fastq_unit_qdesc
      - qual: fastq_unit_qual
    sep: "\n"
    # validation: # external validations required to ensure valid fastq_unit
    # (len(fastq_unit['seq']) == len(fastq_unit['qual'])) and
    #   ((fastq_unit['qdesc']['fastaid'] == "") or
    #   (fastq_unit['qdesc']['fastaid'] == fastq_unit['sdesc']['fastaid']))
  fastq_unit_sdesc:
    composed_of:
      - fastaid: fastq_unit_sdesc_fastaid
      - desc: fastq_unit_sdesc_desctxt
    required: 1
    sep: " "
    split_by_sep: false
    pfx: "@"
  fastq_unit_sdesc_fastaid:
      regex: "[!-~]+"
  fastq_unit_sdesc_desctxt: string
  fastq_unit_seq: string
  fastq_unit_qdesc:
    composed_of:
      - fastaid: fastq_unit_qdesc_fastaid
      - desc: fastq_unit_qdesc_desctxt
    required: 1
    sep: " "
    split_by_sep: false
    pfx: "+"
  fastq_unit_qdesc_fastaid:
    regex: "[!-~]+"
    empty: null
  fastq_unit_qdesc_desctxt: string
  fastq_unit_qual:
    regex: "[!-~]+"
testdata:
  fastq_unit_sdesc_desctxt:
    valid: ["A", "1", "V/zQ,", " ", "a"]
    invalid:
      encoded: [""]
      decoded: [0, 0.0, [], {}, ""]
  fastq_unit_qdesc_desctxt:
    valid: ["A", "1", " ", "{3I=K", "a"]
    invalid:
      encoded: [""]
      decoded: [0, 0.0, [], {}, ""]
  fastq_unit_qdesc_fastaid:
    valid: {";P5i":";P5i", "4":"4", "2":"2", "":null, "lmD":"lmD", "|x":"|x"}
    invalid:
      encoded: []
      decoded: []
  fastq_unit_sdesc_fastaid:
    valid: ["Vw8?:", "AK", "5(%of", "Ym0N", "QPE", "`w", "ZC3Z", "Y'oaU",
            "{VZL", "~"]
    invalid:
      encoded: [""]
      decoded: [""]
  fastq_unit_qdesc:
    valid: {"+\\":{"fastaid":"\\"}, "+\\ A":{"fastaid":"\\","desc":"A"}}
    invalid:
      encoded: [""]
      decoded: [""]
  fastq_unit_sdesc:
    valid: {"@=L Ri;i/":{"fastaid":"=L","desc":"Ri;i/"},
            "@=L":{"fastaid":"=L"}}
    invalid:
      encoded: [""]
      decoded: [""]
  fastq_unit_seq:
    valid: ["A", ",-d~!", "1", " ", "a"]
    invalid:
      encoded: [""]
      decoded: [0, 0.0, [], {}, ""]
  fastq_unit_qual:
    valid: [":;", "C+b", "lM}Z", "Q1W", "2", "hol", "Zu)", "W", "}", ",:s"]
    invalid:
      encoded: [""]
      decoded: [""]
  fastq_unit:
    valid:
      "@P A\nA\n+K(} A\nKm6": {"sdesc":{"fastaid":"P","desc":"A"},"seq":"A","qdesc":{"fastaid":"K(}","desc":"A"},"qual":"Km6"}
    invalid:
      encoded: [""]
      decoded: [""]
